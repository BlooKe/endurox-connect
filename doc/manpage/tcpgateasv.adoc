TCPGATESV(8)
============
:doctype: manpage


NAME
----
tcpgatesv - Enduro/X user programmable tpc gateway (client/server roles, XATMI server).

SYNOPSIS
--------
*tcpgatesv*

DESCRIPTION
-----------
Use programmable tcp gateway. The server gives for programmer abstraction over the tcp
sockets. This module gives programmer abstraction over of the socket to the next level - 
XATMI services. By using tpcgateway for programmer to send network message, it is succficient
for dong the XATMI service invocation with specific UBF buffer, containing the message to
be sent to network. The network address now is abstracted to XATMI service name. All other
details technical details of socket operations are covered by *tcpgatesv*.

The geteway is able to handle multiple simultanious connections. The connections are identified
by connection id, which cosists of two parts - simple connection id (started from Nr. 1) and
by compiled connection id, where part of the number contains the actual timestamp when
connection is established.

Geteway can operate with persistent connections, so that tcpgatesv opens the number of
connections, and callers (from both ends XATMI and network) can do the invocations synchrounsly
or asyncrhouynsly.

Geteway can operate in one request-new connection mode from both ends, it can accept the request
from network (in this case we must be passive - wait for conn). And it can create new connection
when doing the XATMI request to network. After receiving response from network or getting timeout,
the connection is closed.

Module allows the system to track the status of the connections. When gateway boots, it
sends disconnected status to target connection tracking server ('status_svc' service in ini config).
When connection is established either in active or passive mode, the status of connection
is sent to status service.

It is possible to configure gateway to send keep-a-live messages. The keep a live message
is zero length. Thus can be safely ignored by network target device. The same as *tcpgatesv*
does.

Tcpgateway uses different message framing algroythms, to avoid partially read messages
from network, which can occur if message size is larger than message transfer unit (MTU).
Framing mode is controlled by 'framing' parameter. Following options are supported:

. a+ - ASCII formatted string message length

. A+ - ASCII formatted string with message length, including the length bytes

. ll+ - little endian byte order (from one to 8 bytes)

. LL+ - little endian byte order (from one to 8 bytes), message length includes length bytes by it self

. bb+ - big endian byte order (from one to 8 bytes)

. BB+ - big endian byte order (from one to 8 bytes), message length includes length bytes

. d - Message end delimiter byte

. D - Message start and end delimiter byte

Note that if even bytes are used for connection length indication, it is possible,
to swap them in half by using 'framing_half_swap' parameter. This is suitable
for connecting to VISA payment network, which uses little endian 4 bytes, which
are swapped in big endian order by two halves.

The administrator can configure *tcpgatesv* for different roles:

. Tcp socket server - listener (passive mode)

. Tcp socket client - connects  (active mode)

The tcpgateway can operate in different logical modes (type param):

. 'A' - Active mode, our side initiate connection (tcp client)

. 'P' - Passive mode, our side does listen on socket (tcp server)

The next sections will show samples for different framing methods, including
settings of 'framing' and 'framing_half_swap'.

Mode: 'framing' = aa, framing_half_swap=0
-----------------------------------------
TODO

Mode: 'framing' = AAAA, framing_half_swap=0
-------------------------------------------
TODO

Mode: 'framing' = llll, framing_half_swap=1
-------------------------------------------
TODO

Mode: 'framing' = LLLLLL, framing_half_swap=0
---------------------------------------------
TODO

Mode: 'framing' = bbbb, framing_half_swap=0
-------------------------------------------
TODO

Mode: 'framing' = BBBBBBBB, framing_half_swap=1
-----------------------------------------------
TODO

Mode: 'framing' = d, framing_half_swap=N/A
------------------------------------------
TODO

Mode: 'framing' = D, framing_half_swap=N/A
------------------------------------------
TODO

SERVICE API INTERFACE
---------------------
TODO

CONFIGURATION
-------------

The configuration is written in CCONFIG ini file. The section for 
tcp gateway is *[@tcpgate/CCTAG]*. The *CCTAG* is optional. Following
parameters are available for tcp gateway:

*gencore* = 'GENERATE_OS_CORE_DUMPS'::
If set to *1*, for signals 6 (abort), 11 (segmentation fault) default
Operating System handlers will be restored instead of go handlers. This
can be suitable when debugging cgo code.
Default is *0*.

*workers_out* = 'NUMBER_OF_XATMI_SESSIONS_FOR_OUTGOING_MESSAGES'::
.

*workers_in* = 'NUMBER_OF_XATMI_SESSIONS_FOR_INCOMING_MESSAGES'::
.

*gateway* = 'TCP_GATEWAY_SERVICE_NAME'::
.

*framing* = 'FRAMING_MODE'::
.

*framing_half_swap* = 'SWAP_FRAMING_BYTES*::
.

*max_msg_len* = 'MAX_MESSAGE_LENGTH*::
. TODO: Does it include len bytes?

*delim_start* = 'MESSAGE_START_DELIMITER*::
.

*delim_stop* = 'MESSAGE_STOP_DELIMITER*::
.

*type* = 'ACTIVE_PASSIVE_MODE'*::
.

*ip* = 'IP_ADDRESS'*::
.

*port* = 'TPC_PORT_NUMBER'*::
.

*incoming_svc* = 'INCOMING_XATMI_SERVICE'*::
.

*periodic_zero_msg* = 'PERIODIC_ZERO'*::
.

EXIT STATUS
-----------
*0*::
Success

*1*::
Failure

EXAMPLE

To see the usage different usage settings, see *tests/02_tcpgatesv/runtime/conf/tcpgate.ini'*.

BUGS
----
Report bugs to madars.vitolins@gmail.com

SEE ALSO
--------
*restoutsv(8)* *tcpgatesv(8)*.

AUTHOR
------
Enduro/X is created by Madars Vitolins.


COPYING
-------
(C) Mavimax SIA

